# Rotation of shops
execute as @e[type=minecraft:villager,tag=shop] at @s store result score @s gen_rotation run data get entity @a[limit=1,sort=nearest] Rotation[0]
scoreboard players operation @e[type=minecraft:villager,tag=shop] gen_rotation += CONST_180 data
execute as @e[type=minecraft:villager,tag=shop] store result entity @s Rotation[0] float 1.0 run scoreboard players get @s gen_rotation

# Detecting shops
execute as @e[type=minecraft:marker,tag=combat_shop] at @s unless entity @e[type=minecraft:villager,tag=combat_shop,distance=..5] run summon minecraft:villager ~ ~ ~ {Invulnerable:1b,NoAI:1b,Tags:["combat_shop","shop"],CustomName:'{"text":"战斗商店","color":"green","bold":true}',CustomNameVisible:1b,Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",Count:10b,},sell:{id:"minecraft:stone_sword",Count:1b,tag:{StoneSword:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,display:{Name:'{"text":"§f石剑"}',Lore:['{"text":"§7木剑的廉价升级版..."}','""','{"text":"§e>> 价格：§f10 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:7b},sell:{id:"minecraft:iron_sword",Count:1b,tag:{IronSword:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,display:{Name:'{"text":"§f铁剑"}',Lore:['{"text":"§7由纯铁铸造而成，强劲有力。"}','""','{"text":"§e>> 价格：§67 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:4b,},sell:{id:"minecraft:diamond_sword",Count:1b,tag:{DiamondSword:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,display:{Name:'{"text":"§f钻石剑"}',Lore:['{"text":"§7拿着这把象征荣耀的钻石剑横扫战场吧！"}','""','{"text":"§e>> 价格：§a4 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:12b,},sell:{id:"minecraft:stone_axe",Count:1b,tag:{StoneAxe:1,HideFlags:63,CanDestroy:["#game:breakable"],display:{Name:'{"text":"§f石斧"}',Lore:['{"text":"§7“WTF他一斧子砍我10滴血！”"}','""','{"text":"§e>> 价格：§f12 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:9b,},sell:{id:"minecraft:iron_axe",Count:1b,tag:{IronAxe:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,display:{Name:'{"text":"§f铁斧"}',Lore:['{"text":"§7绝佳的武器，甚至能与钻石剑相匹敌。"}','""','{"text":"§e>> 价格：§69 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:6b,},sell:{id:"minecraft:stick",Count:1b,tag:{KnockbackStick:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,Enchantments:[{id:"minecraft:knockback",lvl:1}],display:{Name:'{"text":"§f弹力棒"}',Lore:['{"text":"§7老六模拟器2.0"}','""','{"text":"§e>> 价格：§66 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:32b,},sell:{id:"minecraft:netherite_hoe",Count:1b,tag:{FastHoe:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,Enchantments:[{id:"minecraft:sharpness",lvl:3}],display:{Name:'{"text":"§f合金匕首"}',Lore:['{"text":"§7伤害不高，但能以攻速取胜。"}','""','{"text":"§e>> 价格：§f32 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:32b,},sell:{id:"minecraft:bow",Count:1b,tag:{NormalBow:1,HideFlags:63,Unbreakable:1b,display:{Name:'{"text":"§f普通弓"}',Lore:['{"text":"§7一把平平无奇的弓，但有时能创造奇迹。"}','""','{"text":"§e>> 价格：§f32 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:18b,},sell:{id:"minecraft:bow",Count:1b,tag:{PunchBow:1,HideFlags:63,Unbreakable:1b,Enchantments:[{id:"minecraft:punch",lvl:1}],display:{Name:'{"text":"§f弹力弓"}',Lore:['{"text":"§7“？？？我怎么飞出去了？”"}','""','{"text":"§e>> 价格：§618 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:18b,},sell:{id:"minecraft:bow",Count:1b,tag:{FlameBow:1,HideFlags:63,Unbreakable:1b,Enchantments:[{id:"minecraft:power",lvl:1}],display:{Name:'{"text":"§f力量弓"}',Lore:['{"text":"§7比普通弓更加强劲！"}','""','{"text":"§e>> 价格：§624 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:4b,},sell:{id:"minecraft:bow",Count:1b,tag:{InfinityBow:1,HideFlags:63,Unbreakable:1b,Enchantments:[{id:"minecraft:infinity",lvl:2}],display:{Name:'{"text":"§f无限弓"}',Lore:['{"text":"§7一切恐惧来源于一个空空如也的箭袋。"}','""','{"text":"§e>> 价格：§a4 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:16b,},sell:{id:"minecraft:arrow",Count:8b,tag:{Arrow:1,HideFlags:63,display:{Name:'{"text":"§f箭"}',Lore:['{"text":"§7神射手没有箭也会白给。"}','""','{"text":"§e>> 价格：§f16 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:32b,},sell:{id:"minecraft:chainmail_chestplate",Count:1b,tag:{Armor:1,ChainmailArmor:1,HideFlags:63,Unbreakable:1b,display:{Name:'{"text":"§f锁链盔甲"}',Lore:['{"text":"§7没什么用的铠甲，甚至有点漏水..."}','""','{"text":"§e>> 价格：§f32 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:10b,},sell:{id:"minecraft:iron_chestplate",Count:1b,tag:{Armor:1,IronArmor:1,HideFlags:63,Unbreakable:1b,display:{Name:'{"text":"§f铁盔甲"}',Lore:['{"text":"§7这下可以出去浪了！"}','""','{"text":"§e>> 价格：§610 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:30b,},sell:{id:"minecraft:diamond_chestplate",Count:1b,tag:{Armor:1,DiamondArmor:1,HideFlags:63,Unbreakable:1b,display:{Name:'{"text":"§f钻石盔甲"}',Lore:['{"text":"§7更闪耀，更坚韧！"}','""','{"text":"§e>> 价格：§630 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:6b,},sell:{id:"minecraft:netherite_chestplate",Count:1b,tag:{Armor:1,NetheriteArmor:1,HideFlags:63,Unbreakable:1b,display:{Name:'{"text":"§f下界合金盔甲"}',Lore:['{"text":"§7获得进度：残骸裹身！"}','""','{"text":"§e>> 价格：§a6 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:1b,},sell:{id:"minecraft:shield",Count:1b,tag:{Shield:1,HideFlags:63,Unbreakable:1b,display:{Name:'{"text":"§f盾牌"}',Lore:['{"text":"§7抱歉，今天真的不行..."}','""','{"text":"§e>> 价格：§a1 绿宝石"}']}}},maxUses:2147483647}]}}

execute as @e[type=minecraft:marker,tag=tool_shop] at @s unless entity @e[type=minecraft:villager,tag=tool_shop,distance=..5] run summon minecraft:villager ~ ~ ~ {Invulnerable:1b,NoAI:1b,Tags:["tool_shop","shop"],CustomName:'{"text":"工具商店","color":"green","bold":true}',CustomNameVisible:1b,Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",Count:4b,},sell:{id:"minecraft:light_gray_wool",Count:16b,tag:{Wool:1,HideFlags:63,CanPlaceOn:["#game:placable"],display:{Name:'{"text":"§f羊毛"}',Lore:['{"text":"§7最经典的搭路方块！"}','""','{"text":"§e>> 价格：§f4 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:16b,},sell:{id:"minecraft:white_terracotta",Count:16b,tag:{Terracotta:1,HideFlags:63,CanPlaceOn:["#game:placable"],display:{Name:'{"text":"§f陶瓦"}',Lore:['{"text":"§7看似坚硬，实际它很脆。"}','""','{"text":"§e>> 价格：§f16 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:6b,},sell:{id:"minecraft:end_stone",Count:16b,tag:{Endstone:1,HideFlags:63,CanPlaceOn:["#game:placable"],display:{Name:'{"text":"§f末地石"}',Lore:['{"text":"§7“Why can\'t the Ender Dragon read a book?”"}','""','{"text":"§e>> 价格：§66 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:1b,},sell:{id:"minecraft:ice",Count:1b,tag:{Ice:1,HideFlags:63,CanPlaceOn:["#game:placable"],display:{Name:'{"text":"§f冰块"}',Lore:['{"text":"§7非一日之寒。"}','""','{"text":"§e>> 价格：§a1 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:1b,},sell:{id:"minecraft:polished_deepslate",Count:4b,tag:{Deepslate:1,HideFlags:63,CanPlaceOn:["#game:placable"],display:{Name:'{"text":"§f深板岩"}',Lore:['{"text":"§7绿宝石不够多？我也是不错的选择！"}','""','{"text":"§e>> 价格：§a1 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:2b,},sell:{id:"minecraft:ancient_debris",Count:2b,tag:{AncientDebris:1,HideFlags:63,CanPlaceOn:["#game:placable"],display:{Name:'{"text":"§f远古残骸"}',Lore:['{"text":"§7苟！就硬苟！"}','""','{"text":"§e>> 价格：§a2 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:4b,},sell:{id:"minecraft:shears",Count:1b,tag:{Shears:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,display:{Name:'{"text":"§f剪刀"}',Lore:['{"text":"§7更快地破坏羊毛。"}','""','{"text":"§e>> 价格：§f4 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:4b,},sell:{id:"minecraft:wooden_pickaxe",Count:1b,tag:{WoodenPickaxe:1,HideFlags:63,CanDestroy:["#game:breakable"],Unbreakable:1b,display:{Name:'{"text":"§f木镐"}',Lore:['{"text":"§7我的耐久值不止三点！"}','""','{"text":"§e>> 价格：§f4 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:12b,},sell:{id:"minecraft:stone_pickaxe",Count:1b,tag:{StonePickaxe:1,HideFlags:63,CanDestroy:["#game:breakable"],Enchantments:[{id:"minecraft:efficiency",lvl:1}],Unbreakable:1b,display:{Name:'{"text":"§f石镐"}',Lore:['{"text":"§7挖矿时间到！"}','""','{"text":"§e>> 价格：§f12 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:8b,},sell:{id:"minecraft:diamond_pickaxe",Count:1b,tag:{DiamondPickaxe:1,HideFlags:63,CanDestroy:["#game:breakable"],Enchantments:[{id:"minecraft:efficiency",lvl:1}],Unbreakable:1b,display:{Name:'{"text":"§f钻石镐"}',Lore:['{"text":"§7希望你不会用到它。"}','""','{"text":"§e>> 价格：§68 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:iron_ingot",Count:4b,},sell:{id:"minecraft:cooked_beef",Count:8b,tag:{CookedBeef:1,HideFlags:63,display:{Name:'{"text":"§f牛排"}',Lore:['{"text":"§7没有食物万万不可。"}','""','{"text":"§e>> 价格：§f4 铁锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:3b,},sell:{id:"minecraft:golden_apple",Count:1b,tag:{GoldenApple:1,HideFlags:63,display:{Name:'{"text":"§f金苹果"}',Lore:['{"text":"§7救命神器(x) 壮胆神器(√)"}','""','{"text":"§e>> 价格：§63 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:1b,},sell:{id:"minecraft:egg",Count:1b,tag:{BridgeEgg:1,HideFlags:63,display:{Name:'{"text":"§f搭桥蛋"}',Lore:['{"text":"§7蛋到山前必有路。"}','""','{"text":"§e>> 价格：§a1 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:2b,},sell:{id:"minecraft:torch",Count:1b,tag:{MagicTorch:1,HideFlags:63,display:{Name:'{"text":"§f魔力火炬"}',Lore:['{"text":"§7让15格内的敌人无所遁形！"}','""','{"text":"§e>> 价格：§a2 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:4b,},sell:{id:"minecraft:ender_pearl",Count:1b,tag:{EnderPearl:1,HideFlags:63,display:{Name:'{"text":"§f末影珍珠"}',Lore:['{"text":"§7随风而逝，飘忽不定，给敌人一个惊喜。"}','""','{"text":"§e>> 价格：§a4 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:gold_ingot",Count:8b,},sell:{id:"minecraft:potion",Count:1b,tag:{SwiftPotion:1,HideFlags:63,CustomPotionColor:1000000000,CustomPotionEffects:[{Id:1,Amplifier:1,Duration:900}],display:{Name:'{"text":"§f速度 II 药水（0:45）"}',Lore:['{"text":"§7“我先润了。”"}','""','{"text":"§e>> 价格：§68 金锭"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:1b,},sell:{id:"minecraft:potion",Count:1b,tag:{JumpBoostPotion:1,HideFlags:63,CustomPotionColor:114514191,CustomPotionEffects:[{Id:8,Amplifier:4,Duration:900}],display:{Name:'{"text":"§f跳跃提升 V 药水（0:45）"}',Lore:['{"text":"§7什么东西飞过去了？"}','""','{"text":"§e>> 价格：§a1 绿宝石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:emerald",Count:1b,},sell:{id:"minecraft:potion",Count:2b,tag:{InvisiPotion:1,HideFlags:63,CustomPotionColor:11645361,CustomPotionEffects:[{Id:14,Amplifier:1,Duration:600,ShowParticles:0b}],display:{Name:'{"text":"§f隐身 I 药水（0:30）"}',Lore:['{"text":"§7什么东西飞过去了？"}','""','{"text":"§e>> 价格：§a2 绿宝石"}']}}},maxUses:2147483647}]}}

execute as @e[type=minecraft:marker,tag=buff_shop] at @s unless entity @e[type=minecraft:villager,tag=buff_shop,distance=..5] run summon minecraft:villager ~ ~ ~ {Invulnerable:1b,NoAI:1b,Tags:["buff_shop","shop"],CustomName:'{"text":"增益商店","color":"aqua","bold":true}',CustomNameVisible:1b,Offers:{Recipes:[{buy:{id:"minecraft:diamond",Count:2b,},sell:{id:"minecraft:iron_sword",Count:1b,tag:{ComboMaster:1,buff:1,HideFlags:63,display:{Name:'{"text":"§f连招大师"}',Lore:['{"text":"§7每次近战攻击有§a10%§7的概率给予你"}','{"text":"§a+30%§7的速度加成，效果持续§a2§7秒。"}','{"text":"§c死亡后效果消失！"}','""','{"text":"§e>> 价格：§b2 钻石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:diamond",Count:2b,},sell:{id:"minecraft:redstone",Count:1b,tag:{SoulSiphon:1,buff:1,HideFlags:63,display:{Name:'{"text":"§f噬魂者"}',Lore:['{"text":"§7每次近战攻击时，你有§a8%§7的概率吸取"}','{"text":"§7敌方的§a1.6§c♥§7生命值，冷却时间5秒。"}','{"text":"§c死亡后效果消失！"}','""','{"text":"§e>> 价格：§b2 钻石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:diamond",Count:2b,},sell:{id:"minecraft:iron_ingot",Count:1b,tag:{IronHeart:1,buff:1,HideFlags:63,display:{Name:'{"text":"§f钢铁之心"}',Lore:['{"text":"§7低于§a40%§7生命时，你收到来自剑和"}','{"text":"§7弓箭的伤害减少§a20%§7。"}','{"text":"§c死亡后效果消失！"}','""','{"text":"§e>> 价格：§b2 钻石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:diamond",Count:2b,},sell:{id:"minecraft:red_bed",Count:1b,tag:{DreamDestroyer:1,buff:1,HideFlags:63,display:{Name:'{"text":"§f碎梦人"}',Lore:['{"text":"§7你在敌方基地附近的挖掘速度提升§a20%§7，"}','{"text":"§7攻击速度提升§a10%§7。"}','{"text":"§c死亡后效果消失！"}','""','{"text":"§e>> 价格：§b2 钻石"}']}}},maxUses:2147483647},{buy:{id:"minecraft:diamond",Count:4b,},sell:{id:"minecraft:golden_apple",Count:1b,tag:{Warrior:1,buff:1,HideFlags:63,display:{Name:'{"text":"§f圣战士"}',Lore:['{"text":"§7获得§a+4§c♥§7生命上限。"}','{"text":"§c死亡后效果消失！"}','""','{"text":"§e>> 价格：§b4 钻石"}']}}},maxUses:2147483647}]}}